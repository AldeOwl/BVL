"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function reqListener() {
  var data = JSON.parse(this.responseText);
  console.log(data);
}

function reqError(err) {
  console.log('Fetch Error :-S', err);
}

var oReq = new XMLHttpRequest();
oReq.onload = reqListener;
oReq.onerror = reqError;
oReq.open('get', 'http://myvolley.ru/api/tournament?request=teams&id=397', true);
oReq.send();
var feed = new Instafeed({
  get: 'user',
  userId: '212406086',
  accessToken: '212406086.b242790.ad724d1a02ee43ca812e5ace3850f277'
});
feed.run();
var mainMenu = document.querySelectorAll('.menu__item');
var sections = document.querySelectorAll('.main');

function onMenu() {
  mainMenu.forEach(function (item) {
    item.classList.remove('menu__item-active');
  });
  sections.forEach(function (item) {
    item.classList.remove('main-active');
  });
  this.classList.add('menu__item-active');
  var menuId = this.getAttribute('data-menu');
  sections.forEach(function (item) {
    if (item.getAttribute('data-section') == menuId) item.classList.add('main-active');
  });
}

mainMenu.forEach(function (item) {
  item.addEventListener('click', onMenu);
});

var Render =
/*#__PURE__*/
function () {
  function Render() {
    _classCallCheck(this, Render);

    this.teamList = document.querySelector('.teams__item');
  }

  _createClass(Render, [{
    key: "drowTeamList",
    value: function drowTeamList() {}
  }]);

  return Render;
}();

(function () {
  var select = document.querySelector('.teams-select');
  var list = document.querySelector('.teams-list');
  var icon = document.querySelector('.teams-select__item');
  var teamList = document.querySelector('.list-view');
  var selectImg = document.querySelector('#targetImg');
  var selectName = document.querySelector('#targetName');
  var infoMenu = document.querySelectorAll('.info-menu__item');
  var teamSection = document.querySelectorAll('.team-section');
  var playersList = document.querySelector('.players-list');
  var allTeams = 0;

  function showTeamList() {
    list.classList.toggle('teams-list-active');
    icon.classList.toggle('teams-select__item-active');
  }

  function renderTeamList(teamName, teamId) {
    var li = document.createElement('li');
    li.classList.add('list-view__item');
    var wrap = document.createElement('div');
    wrap.classList.add('teams__link'); // let img = document.createElement('img');
    // img.classList.add('teams__link-img');
    // img.setAttribute('href', '#');

    var name = document.createElement('h3');
    name.classList.add('teams__link-title');
    name.setAttribute('data-id', teamId);
    name.addEventListener('click', function () {
      console.log(event.target.innerHTML);
      selectName.innerHTML = event.target.innerHTML;
      var id = event.target.getAttribute('data-id');
      selectName.setAttribute('data-id', id);
      removePlayerCard();
      showPlayers();
    });
    name.innerHTML = teamName; // wrap.appendChild(img);

    wrap.appendChild(name);
    li.appendChild(wrap);
    teamList.appendChild(li);
  }

  function cat(str) {
    return str.split(' ');
  }

  function renderPlayerCard(name, birthday, height, number, photo) {
    var card = document.createElement('div');
    card.classList.add('player-card');
    var img = document.createElement('img');
    img.classList.add('player-card__img');
    img.setAttribute('src', photo);
    var cardInfo = document.createElement('div');
    cardInfo.classList.add('player-card__info');
    var title = document.createElement('div');
    title.classList.add('card-title');
    var num = document.createElement('p');
    num.classList.add('card-info__number');
    num.innerHTML = number;
    var playerName = document.createElement('h3');
    playerName.classList.add('card-info__name');
    playerName.innerHTML = "".concat(name[0], " ").concat(name[1]);
    var birth = document.createElement('p');
    birth.classList.add('card-info__birth');
    birth.innerHTML = "<span>\u0414\u0430\u0442\u0430 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F: </span> ".concat(birthday);
    var playerHeight = document.createElement('p');
    playerHeight.classList.add('card-info__height');
    playerHeight.innerHTML = "<span>\u0420\u043E\u0441\u0442: </span> ".concat(height);
    var btn = document.createElement('div');
    btn.classList.add('card-info__profile');
    btn.innerHTML = 'подробнее';
    title.appendChild(num);
    title.appendChild(playerName);
    cardInfo.appendChild(title);
    cardInfo.appendChild(birth);
    cardInfo.appendChild(playerHeight);
    cardInfo.appendChild(btn);
    card.appendChild(img);
    card.appendChild(cardInfo);
    playersList.appendChild(card);
  }

  function removePlayerCard() {
    while (playersList.firstChild) {
      playersList.removeChild(playersList.firstChild);
    }
  }

  function showPlayers() {
    var id = selectName.getAttribute('data-id');
    allTeams[0].forEach(function (item) {
      if (item.teamId == id) {
        item.players.forEach(function (item) {
          renderPlayerCard(cat(item.playerName), item.birthday, item.height, item.number, item.photo);
        });
      }
    });
  }

  function chooseSection() {
    infoMenu.forEach(function (item) {
      item.classList.remove('info-menu__item-active');
    });
    teamSection.forEach(function (item) {
      item.classList.remove('team-section-active');
    });
    this.classList.add('info-menu__item-active');
    var name = this.getAttribute('data-name');
    teamSection.forEach(function (item) {
      if (item.getAttribute('data-name') === name) {
        item.classList.add('team-section-active');
      }
    });
  }

  infoMenu.forEach(function (item) {
    item.addEventListener('click', chooseSection);
  });
  select.addEventListener('click', showTeamList);
  fetch("http://myvolley.ru/api/tournament?request=teams&id=384").then(function (res) {
    return res.json();
  }).then(function (json) {
    console.log(json);
    allTeams = json;
    var formatedResult = [];
    json[0].map(function (item) {
      var teamName = item.teamName,
          teamId = item.teamId;
      formatedResult.push({
        teamName: teamName,
        teamId: teamId
      });
    });
    return formatedResult;
  }).then(function (result) {
    result.forEach(function (item) {
      renderTeamList(item.teamName, item.teamId);
    });
  });
})();

var teams = {
  rus: {
    title: 'Russia',
    flag: 'images/rus.jpg'
  }
};
var country = document.querySelector('.teams__link-title');
var flag = document.querySelector('.teams__link-img');
country.innerHTML = teams.rus.title;
flag.setAttribute('src', teams.rus.flag);
var menu = document.querySelectorAll('.pools-menu__item');
var pools = document.querySelectorAll('.pools-list__item');

function choosePool() {
  menu.forEach(function (item) {
    item.classList.remove('pools-menu__item-active');
  });
  pools.forEach(function (item) {
    item.classList.remove('pools-list__item-active');
  });
  this.classList.add('pools-menu__item-active');
  var group = this.getAttribute('data-group');
  pools.forEach(function (item) {
    if (item.getAttribute('data-group') === group) {
      item.classList.add('pools-list__item-active');
    }
  });
}

menu.forEach(function (item) {
  item.addEventListener('click', choosePool);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldERhdGEuanMiLCJpbmRleC5qcyIsIm1haW5NZW51LmpzIiwicmVuZGVyLmpzIiwidGVhbUNob2ljZS5qcyIsInRlYW1zLmpzIiwidHVyblBvb2xzLmpzIl0sIm5hbWVzIjpbInJlcUxpc3RlbmVyIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsImNvbnNvbGUiLCJsb2ciLCJyZXFFcnJvciIsImVyciIsIm9SZXEiLCJYTUxIdHRwUmVxdWVzdCIsIm9ubG9hZCIsIm9uZXJyb3IiLCJvcGVuIiwic2VuZCIsImZlZWQiLCJJbnN0YWZlZWQiLCJnZXQiLCJ1c2VySWQiLCJhY2Nlc3NUb2tlbiIsInJ1biIsIm1haW5NZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2VjdGlvbnMiLCJvbk1lbnUiLCJmb3JFYWNoIiwiaXRlbSIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsIm1lbnVJZCIsImdldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJSZW5kZXIiLCJ0ZWFtTGlzdCIsInF1ZXJ5U2VsZWN0b3IiLCJzZWxlY3QiLCJsaXN0IiwiaWNvbiIsInNlbGVjdEltZyIsInNlbGVjdE5hbWUiLCJpbmZvTWVudSIsInRlYW1TZWN0aW9uIiwicGxheWVyc0xpc3QiLCJhbGxUZWFtcyIsInNob3dUZWFtTGlzdCIsInRvZ2dsZSIsInJlbmRlclRlYW1MaXN0IiwidGVhbU5hbWUiLCJ0ZWFtSWQiLCJsaSIsImNyZWF0ZUVsZW1lbnQiLCJ3cmFwIiwibmFtZSIsInNldEF0dHJpYnV0ZSIsImV2ZW50IiwidGFyZ2V0IiwiaW5uZXJIVE1MIiwiaWQiLCJyZW1vdmVQbGF5ZXJDYXJkIiwic2hvd1BsYXllcnMiLCJhcHBlbmRDaGlsZCIsImNhdCIsInN0ciIsInNwbGl0IiwicmVuZGVyUGxheWVyQ2FyZCIsImJpcnRoZGF5IiwiaGVpZ2h0IiwibnVtYmVyIiwicGhvdG8iLCJjYXJkIiwiaW1nIiwiY2FyZEluZm8iLCJ0aXRsZSIsIm51bSIsInBsYXllck5hbWUiLCJiaXJ0aCIsInBsYXllckhlaWdodCIsImJ0biIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInBsYXllcnMiLCJjaG9vc2VTZWN0aW9uIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwianNvbiIsImZvcm1hdGVkUmVzdWx0IiwibWFwIiwicHVzaCIsInJlc3VsdCIsInRlYW1zIiwicnVzIiwiZmxhZyIsImNvdW50cnkiLCJtZW51IiwicG9vbHMiLCJjaG9vc2VQb29sIiwiZ3JvdXAiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsU0FBQUEsV0FBQSxHQUFBO0FBQ0EsTUFBQUMsSUFBQSxHQUFBQyxJQUFBLENBQUFDLEtBQUEsQ0FBQSxLQUFBQyxZQUFBLENBQUE7QUFDQUMsRUFBQUEsT0FBQSxDQUFBQyxHQUFBLENBQUFMLElBQUE7QUFDQTs7QUFFQSxTQUFBTSxRQUFBLENBQUFDLEdBQUEsRUFBQTtBQUNBSCxFQUFBQSxPQUFBLENBQUFDLEdBQUEsQ0FBQSxpQkFBQSxFQUFBRSxHQUFBO0FBQ0E7O0FBRUEsSUFBQUMsSUFBQSxHQUFBLElBQUFDLGNBQUEsRUFBQTtBQUNBRCxJQUFBLENBQUFFLE1BQUEsR0FBQVgsV0FBQTtBQUNBUyxJQUFBLENBQUFHLE9BQUEsR0FBQUwsUUFBQTtBQUNBRSxJQUFBLENBQUFJLElBQUEsQ0FBQSxLQUFBLEVBQUEsd0RBQUEsRUFBQSxJQUFBO0FBQ0FKLElBQUEsQ0FBQUssSUFBQTtBQ2JBLElBQUFDLElBQUEsR0FBQSxJQUFBQyxTQUFBLENBQUE7QUFDQUMsRUFBQUEsR0FBQSxFQUFBLE1BREE7QUFFQUMsRUFBQUEsTUFBQSxFQUFBLFdBRkE7QUFHQUMsRUFBQUEsV0FBQSxFQUFBO0FBSEEsQ0FBQSxDQUFBO0FBS0FKLElBQUEsQ0FBQUssR0FBQTtBQ0xBLElBQUFDLFFBQUEsR0FBQUMsUUFBQSxDQUFBQyxnQkFBQSxDQUFBLGFBQUEsQ0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsUUFBQSxDQUFBQyxnQkFBQSxDQUFBLE9BQUEsQ0FBQTs7QUFFQSxTQUFBRSxNQUFBLEdBQUE7QUFDQUosRUFBQUEsUUFBQSxDQUFBSyxPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0FBLElBQUFBLElBQUEsQ0FBQUMsU0FBQSxDQUFBQyxNQUFBLENBQUEsbUJBQUE7QUFDQSxHQUZBO0FBR0FMLEVBQUFBLFFBQUEsQ0FBQUUsT0FBQSxDQUFBLFVBQUFDLElBQUEsRUFBQTtBQUNBQSxJQUFBQSxJQUFBLENBQUFDLFNBQUEsQ0FBQUMsTUFBQSxDQUFBLGFBQUE7QUFDQSxHQUZBO0FBSUEsT0FBQUQsU0FBQSxDQUFBRSxHQUFBLENBQUEsbUJBQUE7QUFDQSxNQUFBQyxNQUFBLEdBQUEsS0FBQUMsWUFBQSxDQUFBLFdBQUEsQ0FBQTtBQUNBUixFQUFBQSxRQUFBLENBQUFFLE9BQUEsQ0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQSxRQUFBQSxJQUFBLENBQUFLLFlBQUEsQ0FBQSxjQUFBLEtBQUFELE1BQUEsRUFDQUosSUFBQSxDQUFBQyxTQUFBLENBQUFFLEdBQUEsQ0FBQSxhQUFBO0FBQUEsR0FGQTtBQUdBOztBQUVBVCxRQUFBLENBQUFLLE9BQUEsQ0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQUEsRUFBQUEsSUFBQSxDQUFBTSxnQkFBQSxDQUFBLE9BQUEsRUFBQVIsTUFBQTtBQUNBLENBRkE7O0lDbEJBUyxNOzs7QUFDQSxvQkFBQTtBQUFBOztBQUNBLFNBQUFDLFFBQUEsR0FBQWIsUUFBQSxDQUFBYyxhQUFBLENBQUEsY0FBQSxDQUFBO0FBQ0E7Ozs7bUNBRUEsQ0FFQTs7Ozs7O0FDUEEsQ0FBQSxZQUFBO0FBQ0EsTUFBQUMsTUFBQSxHQUFBZixRQUFBLENBQUFjLGFBQUEsQ0FBQSxlQUFBLENBQUE7QUFDQSxNQUFBRSxJQUFBLEdBQUFoQixRQUFBLENBQUFjLGFBQUEsQ0FBQSxhQUFBLENBQUE7QUFDQSxNQUFBRyxJQUFBLEdBQUFqQixRQUFBLENBQUFjLGFBQUEsQ0FBQSxxQkFBQSxDQUFBO0FBQ0EsTUFBQUQsUUFBQSxHQUFBYixRQUFBLENBQUFjLGFBQUEsQ0FBQSxZQUFBLENBQUE7QUFDQSxNQUFBSSxTQUFBLEdBQUFsQixRQUFBLENBQUFjLGFBQUEsQ0FBQSxZQUFBLENBQUE7QUFDQSxNQUFBSyxVQUFBLEdBQUFuQixRQUFBLENBQUFjLGFBQUEsQ0FBQSxhQUFBLENBQUE7QUFDQSxNQUFBTSxRQUFBLEdBQUFwQixRQUFBLENBQUFDLGdCQUFBLENBQUEsa0JBQUEsQ0FBQTtBQUNBLE1BQUFvQixXQUFBLEdBQUFyQixRQUFBLENBQUFDLGdCQUFBLENBQUEsZUFBQSxDQUFBO0FBQ0EsTUFBQXFCLFdBQUEsR0FBQXRCLFFBQUEsQ0FBQWMsYUFBQSxDQUFBLGVBQUEsQ0FBQTtBQUlBLE1BQUFTLFFBQUEsR0FBQSxDQUFBOztBQUVBLFdBQUFDLFlBQUEsR0FBQTtBQUNBUixJQUFBQSxJQUFBLENBQUFWLFNBQUEsQ0FBQW1CLE1BQUEsQ0FBQSxtQkFBQTtBQUNBUixJQUFBQSxJQUFBLENBQUFYLFNBQUEsQ0FBQW1CLE1BQUEsQ0FBQSwyQkFBQTtBQUNBOztBQUNBLFdBQUFDLGNBQUEsQ0FBQUMsUUFBQSxFQUFBQyxNQUFBLEVBQUE7QUFDQSxRQUFBQyxFQUFBLEdBQUE3QixRQUFBLENBQUE4QixhQUFBLENBQUEsSUFBQSxDQUFBO0FBQ0FELElBQUFBLEVBQUEsQ0FBQXZCLFNBQUEsQ0FBQUUsR0FBQSxDQUFBLGlCQUFBO0FBRUEsUUFBQXVCLElBQUEsR0FBQS9CLFFBQUEsQ0FBQThCLGFBQUEsQ0FBQSxLQUFBLENBQUE7QUFDQUMsSUFBQUEsSUFBQSxDQUFBekIsU0FBQSxDQUFBRSxHQUFBLENBQUEsYUFBQSxFQUxBLENBT0E7QUFDQTtBQUNBOztBQUVBLFFBQUF3QixJQUFBLEdBQUFoQyxRQUFBLENBQUE4QixhQUFBLENBQUEsSUFBQSxDQUFBO0FBQ0FFLElBQUFBLElBQUEsQ0FBQTFCLFNBQUEsQ0FBQUUsR0FBQSxDQUFBLG1CQUFBO0FBQ0F3QixJQUFBQSxJQUFBLENBQUFDLFlBQUEsQ0FBQSxTQUFBLEVBQUFMLE1BQUE7QUFDQUksSUFBQUEsSUFBQSxDQUFBckIsZ0JBQUEsQ0FBQSxPQUFBLEVBQUEsWUFBQTtBQUNBNUIsTUFBQUEsT0FBQSxDQUFBQyxHQUFBLENBQUFrRCxLQUFBLENBQUFDLE1BQUEsQ0FBQUMsU0FBQTtBQUNBakIsTUFBQUEsVUFBQSxDQUFBaUIsU0FBQSxHQUFBRixLQUFBLENBQUFDLE1BQUEsQ0FBQUMsU0FBQTtBQUNBLFVBQUFDLEVBQUEsR0FBQUgsS0FBQSxDQUFBQyxNQUFBLENBQUF6QixZQUFBLENBQUEsU0FBQSxDQUFBO0FBQ0FTLE1BQUFBLFVBQUEsQ0FBQWMsWUFBQSxDQUFBLFNBQUEsRUFBQUksRUFBQTtBQUNBQyxNQUFBQSxnQkFBQTtBQUNBQyxNQUFBQSxXQUFBO0FBQ0EsS0FQQTtBQVNBUCxJQUFBQSxJQUFBLENBQUFJLFNBQUEsR0FBQVQsUUFBQSxDQXZCQSxDQXlCQTs7QUFDQUksSUFBQUEsSUFBQSxDQUFBUyxXQUFBLENBQUFSLElBQUE7QUFDQUgsSUFBQUEsRUFBQSxDQUFBVyxXQUFBLENBQUFULElBQUE7QUFDQWxCLElBQUFBLFFBQUEsQ0FBQTJCLFdBQUEsQ0FBQVgsRUFBQTtBQUNBOztBQUNBLFdBQUFZLEdBQUEsQ0FBQUMsR0FBQSxFQUFBO0FBQ0EsV0FBQUEsR0FBQSxDQUFBQyxLQUFBLENBQUEsR0FBQSxDQUFBO0FBQ0E7O0FBQ0EsV0FBQUMsZ0JBQUEsQ0FBQVosSUFBQSxFQUFBYSxRQUFBLEVBQUFDLE1BQUEsRUFBQUMsTUFBQSxFQUFBQyxLQUFBLEVBQUE7QUFDQSxRQUFBQyxJQUFBLEdBQUFqRCxRQUFBLENBQUE4QixhQUFBLENBQUEsS0FBQSxDQUFBO0FBQ0FtQixJQUFBQSxJQUFBLENBQUEzQyxTQUFBLENBQUFFLEdBQUEsQ0FBQSxhQUFBO0FBRUEsUUFBQTBDLEdBQUEsR0FBQWxELFFBQUEsQ0FBQThCLGFBQUEsQ0FBQSxLQUFBLENBQUE7QUFDQW9CLElBQUFBLEdBQUEsQ0FBQTVDLFNBQUEsQ0FBQUUsR0FBQSxDQUFBLGtCQUFBO0FBQ0EwQyxJQUFBQSxHQUFBLENBQUFqQixZQUFBLENBQUEsS0FBQSxFQUFBZSxLQUFBO0FBRUEsUUFBQUcsUUFBQSxHQUFBbkQsUUFBQSxDQUFBOEIsYUFBQSxDQUFBLEtBQUEsQ0FBQTtBQUNBcUIsSUFBQUEsUUFBQSxDQUFBN0MsU0FBQSxDQUFBRSxHQUFBLENBQUEsbUJBQUE7QUFFQSxRQUFBNEMsS0FBQSxHQUFBcEQsUUFBQSxDQUFBOEIsYUFBQSxDQUFBLEtBQUEsQ0FBQTtBQUNBc0IsSUFBQUEsS0FBQSxDQUFBOUMsU0FBQSxDQUFBRSxHQUFBLENBQUEsWUFBQTtBQUVBLFFBQUE2QyxHQUFBLEdBQUFyRCxRQUFBLENBQUE4QixhQUFBLENBQUEsR0FBQSxDQUFBO0FBQ0F1QixJQUFBQSxHQUFBLENBQUEvQyxTQUFBLENBQUFFLEdBQUEsQ0FBQSxtQkFBQTtBQUNBNkMsSUFBQUEsR0FBQSxDQUFBakIsU0FBQSxHQUFBVyxNQUFBO0FBRUEsUUFBQU8sVUFBQSxHQUFBdEQsUUFBQSxDQUFBOEIsYUFBQSxDQUFBLElBQUEsQ0FBQTtBQUNBd0IsSUFBQUEsVUFBQSxDQUFBaEQsU0FBQSxDQUFBRSxHQUFBLENBQUEsaUJBQUE7QUFDQThDLElBQUFBLFVBQUEsQ0FBQWxCLFNBQUEsYUFBQUosSUFBQSxDQUFBLENBQUEsQ0FBQSxjQUFBQSxJQUFBLENBQUEsQ0FBQSxDQUFBO0FBRUEsUUFBQXVCLEtBQUEsR0FBQXZELFFBQUEsQ0FBQThCLGFBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQXlCLElBQUFBLEtBQUEsQ0FBQWpELFNBQUEsQ0FBQUUsR0FBQSxDQUFBLGtCQUFBO0FBQ0ErQyxJQUFBQSxLQUFBLENBQUFuQixTQUFBLHNHQUFBUyxRQUFBO0FBRUEsUUFBQVcsWUFBQSxHQUFBeEQsUUFBQSxDQUFBOEIsYUFBQSxDQUFBLEdBQUEsQ0FBQTtBQUNBMEIsSUFBQUEsWUFBQSxDQUFBbEQsU0FBQSxDQUFBRSxHQUFBLENBQUEsbUJBQUE7QUFDQWdELElBQUFBLFlBQUEsQ0FBQXBCLFNBQUEscURBQUFVLE1BQUE7QUFFQSxRQUFBVyxHQUFBLEdBQUF6RCxRQUFBLENBQUE4QixhQUFBLENBQUEsS0FBQSxDQUFBO0FBQ0EyQixJQUFBQSxHQUFBLENBQUFuRCxTQUFBLENBQUFFLEdBQUEsQ0FBQSxvQkFBQTtBQUNBaUQsSUFBQUEsR0FBQSxDQUFBckIsU0FBQSxHQUFBLFdBQUE7QUFFQWdCLElBQUFBLEtBQUEsQ0FBQVosV0FBQSxDQUFBYSxHQUFBO0FBQ0FELElBQUFBLEtBQUEsQ0FBQVosV0FBQSxDQUFBYyxVQUFBO0FBRUFILElBQUFBLFFBQUEsQ0FBQVgsV0FBQSxDQUFBWSxLQUFBO0FBQ0FELElBQUFBLFFBQUEsQ0FBQVgsV0FBQSxDQUFBZSxLQUFBO0FBQ0FKLElBQUFBLFFBQUEsQ0FBQVgsV0FBQSxDQUFBZ0IsWUFBQTtBQUNBTCxJQUFBQSxRQUFBLENBQUFYLFdBQUEsQ0FBQWlCLEdBQUE7QUFFQVIsSUFBQUEsSUFBQSxDQUFBVCxXQUFBLENBQUFVLEdBQUE7QUFDQUQsSUFBQUEsSUFBQSxDQUFBVCxXQUFBLENBQUFXLFFBQUE7QUFFQTdCLElBQUFBLFdBQUEsQ0FBQWtCLFdBQUEsQ0FBQVMsSUFBQTtBQUNBOztBQUNBLFdBQUFYLGdCQUFBLEdBQUE7QUFDQSxXQUFBaEIsV0FBQSxDQUFBb0MsVUFBQSxFQUFBO0FBQ0FwQyxNQUFBQSxXQUFBLENBQUFxQyxXQUFBLENBQUFyQyxXQUFBLENBQUFvQyxVQUFBO0FBQ0E7QUFDQTs7QUFDQSxXQUFBbkIsV0FBQSxHQUFBO0FBQ0EsUUFBQUYsRUFBQSxHQUFBbEIsVUFBQSxDQUFBVCxZQUFBLENBQUEsU0FBQSxDQUFBO0FBQ0FhLElBQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQW5CLE9BQUEsQ0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQSxVQUFBQSxJQUFBLENBQUF1QixNQUFBLElBQUFTLEVBQUEsRUFBQTtBQUNBaEMsUUFBQUEsSUFBQSxDQUFBdUQsT0FBQSxDQUFBeEQsT0FBQSxDQUFBLFVBQUFDLElBQUEsRUFBQTtBQUNBdUMsVUFBQUEsZ0JBQUEsQ0FBQUgsR0FBQSxDQUFBcEMsSUFBQSxDQUFBaUQsVUFBQSxDQUFBLEVBQ0FqRCxJQUFBLENBQUF3QyxRQURBLEVBRUF4QyxJQUFBLENBQUF5QyxNQUZBLEVBR0F6QyxJQUFBLENBQUEwQyxNQUhBLEVBSUExQyxJQUFBLENBQUEyQyxLQUpBLENBQUE7QUFLQSxTQU5BO0FBT0E7QUFDQSxLQVZBO0FBWUE7O0FBRUEsV0FBQWEsYUFBQSxHQUFBO0FBQ0F6QyxJQUFBQSxRQUFBLENBQUFoQixPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0FBLE1BQUFBLElBQUEsQ0FBQUMsU0FBQSxDQUFBQyxNQUFBLENBQUEsd0JBQUE7QUFDQSxLQUZBO0FBR0FjLElBQUFBLFdBQUEsQ0FBQWpCLE9BQUEsQ0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQUEsTUFBQUEsSUFBQSxDQUFBQyxTQUFBLENBQUFDLE1BQUEsQ0FBQSxxQkFBQTtBQUNBLEtBRkE7QUFJQSxTQUFBRCxTQUFBLENBQUFFLEdBQUEsQ0FBQSx3QkFBQTtBQUNBLFFBQUF3QixJQUFBLEdBQUEsS0FBQXRCLFlBQUEsQ0FBQSxXQUFBLENBQUE7QUFDQVcsSUFBQUEsV0FBQSxDQUFBakIsT0FBQSxDQUFBLFVBQUFDLElBQUEsRUFBQTtBQUNBLFVBQUFBLElBQUEsQ0FBQUssWUFBQSxDQUFBLFdBQUEsTUFBQXNCLElBQUEsRUFBQTtBQUNBM0IsUUFBQUEsSUFBQSxDQUFBQyxTQUFBLENBQUFFLEdBQUEsQ0FBQSxxQkFBQTtBQUNBO0FBQ0EsS0FKQTtBQUtBOztBQUVBWSxFQUFBQSxRQUFBLENBQUFoQixPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0FBLElBQUFBLElBQUEsQ0FBQU0sZ0JBQUEsQ0FBQSxPQUFBLEVBQUFrRCxhQUFBO0FBQ0EsR0FGQTtBQUdBOUMsRUFBQUEsTUFBQSxDQUFBSixnQkFBQSxDQUFBLE9BQUEsRUFBQWEsWUFBQTtBQUdBc0MsRUFBQUEsS0FBQSwwREFBQSxDQUNBQyxJQURBLENBQ0EsVUFBQUMsR0FBQTtBQUFBLFdBQUFBLEdBQUEsQ0FBQUMsSUFBQSxFQUFBO0FBQUEsR0FEQSxFQUVBRixJQUZBLENBRUEsVUFBQUUsSUFBQSxFQUFBO0FBQ0FsRixJQUFBQSxPQUFBLENBQUFDLEdBQUEsQ0FBQWlGLElBQUE7QUFDQTFDLElBQUFBLFFBQUEsR0FBQTBDLElBQUE7QUFDQSxRQUFBQyxjQUFBLEdBQUEsRUFBQTtBQUVBRCxJQUFBQSxJQUFBLENBQUEsQ0FBQSxDQUFBLENBQUFFLEdBQUEsQ0FBQSxVQUFBOUQsSUFBQSxFQUFBO0FBQUEsVUFFQXNCLFFBRkEsR0FJQXRCLElBSkEsQ0FFQXNCLFFBRkE7QUFBQSxVQUdBQyxNQUhBLEdBSUF2QixJQUpBLENBR0F1QixNQUhBO0FBTUFzQyxNQUFBQSxjQUFBLENBQUFFLElBQUEsQ0FBQTtBQUNBekMsUUFBQUEsUUFBQSxFQUFBQSxRQURBO0FBRUFDLFFBQUFBLE1BQUEsRUFBQUE7QUFGQSxPQUFBO0FBSUEsS0FWQTtBQVdBLFdBQUFzQyxjQUFBO0FBQ0EsR0FuQkEsRUFvQkFILElBcEJBLENBb0JBLFVBQUFNLE1BQUEsRUFBQTtBQUNBQSxJQUFBQSxNQUFBLENBQUFqRSxPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0FxQixNQUFBQSxjQUFBLENBQUFyQixJQUFBLENBQUFzQixRQUFBLEVBQUF0QixJQUFBLENBQUF1QixNQUFBLENBQUE7QUFDQSxLQUZBO0FBR0EsR0F4QkE7QUEwQkEsQ0F6S0E7O0FDQ0EsSUFBQTBDLEtBQUEsR0FBQTtBQUNBQyxFQUFBQSxHQUFBLEVBQUE7QUFDQW5CLElBQUFBLEtBQUEsRUFBQSxRQURBO0FBRUFvQixJQUFBQSxJQUFBLEVBQUE7QUFGQTtBQURBLENBQUE7QUFPQSxJQUFBQyxPQUFBLEdBQUF6RSxRQUFBLENBQUFjLGFBQUEsQ0FBQSxvQkFBQSxDQUFBO0FBQ0EsSUFBQTBELElBQUEsR0FBQXhFLFFBQUEsQ0FBQWMsYUFBQSxDQUFBLGtCQUFBLENBQUE7QUFFQTJELE9BQUEsQ0FBQXJDLFNBQUEsR0FBQWtDLEtBQUEsQ0FBQUMsR0FBQSxDQUFBbkIsS0FBQTtBQUNBb0IsSUFBQSxDQUFBdkMsWUFBQSxDQUFBLEtBQUEsRUFBQXFDLEtBQUEsQ0FBQUMsR0FBQSxDQUFBQyxJQUFBO0FDWkEsSUFBQUUsSUFBQSxHQUFBMUUsUUFBQSxDQUFBQyxnQkFBQSxDQUFBLG1CQUFBLENBQUE7QUFDQSxJQUFBMEUsS0FBQSxHQUFBM0UsUUFBQSxDQUFBQyxnQkFBQSxDQUFBLG1CQUFBLENBQUE7O0FBR0EsU0FBQTJFLFVBQUEsR0FBQTtBQUNBRixFQUFBQSxJQUFBLENBQUF0RSxPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0FBLElBQUFBLElBQUEsQ0FBQUMsU0FBQSxDQUFBQyxNQUFBLENBQUEseUJBQUE7QUFDQSxHQUZBO0FBR0FvRSxFQUFBQSxLQUFBLENBQUF2RSxPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0FBLElBQUFBLElBQUEsQ0FBQUMsU0FBQSxDQUFBQyxNQUFBLENBQUEseUJBQUE7QUFDQSxHQUZBO0FBSUEsT0FBQUQsU0FBQSxDQUFBRSxHQUFBLENBQUEseUJBQUE7QUFDQSxNQUFBcUUsS0FBQSxHQUFBLEtBQUFuRSxZQUFBLENBQUEsWUFBQSxDQUFBO0FBQ0FpRSxFQUFBQSxLQUFBLENBQUF2RSxPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0EsUUFBQUEsSUFBQSxDQUFBSyxZQUFBLENBQUEsWUFBQSxNQUFBbUUsS0FBQSxFQUFBO0FBQ0F4RSxNQUFBQSxJQUFBLENBQUFDLFNBQUEsQ0FBQUUsR0FBQSxDQUFBLHlCQUFBO0FBQ0E7QUFDQSxHQUpBO0FBS0E7O0FBR0FrRSxJQUFBLENBQUF0RSxPQUFBLENBQUEsVUFBQUMsSUFBQSxFQUFBO0FBQ0FBLEVBQUFBLElBQUEsQ0FBQU0sZ0JBQUEsQ0FBQSxPQUFBLEVBQUFpRSxVQUFBO0FBQ0EsQ0FGQSIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcmVxTGlzdGVuZXIoKSB7ICBcbiAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZVRleHQpOyAgXG4gICAgY29uc29sZS5sb2coZGF0YSk7ICBcbiAgfVxuICBcbiAgZnVuY3Rpb24gcmVxRXJyb3IoZXJyKSB7ICBcbiAgICBjb25zb2xlLmxvZygnRmV0Y2ggRXJyb3IgOi1TJywgZXJyKTsgIFxuICB9XG4gIFxuICB2YXIgb1JlcSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyAgXG4gIG9SZXEub25sb2FkID0gcmVxTGlzdGVuZXI7ICBcbiAgb1JlcS5vbmVycm9yID0gcmVxRXJyb3I7ICBcbiAgb1JlcS5vcGVuKCdnZXQnLCAnaHR0cDovL215dm9sbGV5LnJ1L2FwaS90b3VybmFtZW50P3JlcXVlc3Q9dGVhbXMmaWQ9Mzk3JywgdHJ1ZSk7ICBcbiAgb1JlcS5zZW5kKCkiLCIgICAgbGV0IGZlZWQgPSBuZXcgSW5zdGFmZWVkKHtcbiAgICAgICAgZ2V0OiAndXNlcicsXG4gICAgICAgIHVzZXJJZDogJzIxMjQwNjA4NicsXG4gICAgICAgIGFjY2Vzc1Rva2VuOicyMTI0MDYwODYuYjI0Mjc5MC5hZDcyNGQxYTAyZWU0M2NhODEyZTVhY2UzODUwZjI3NycsXG4gICAgfSk7XG4gICAgZmVlZC5ydW4oKTtcbiIsImxldCBtYWluTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51X19pdGVtJyk7XG5sZXQgc2VjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWFpbicpO1xuXG5mdW5jdGlvbiBvbk1lbnUgKCl7XG4gICAgbWFpbk1lbnUuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ21lbnVfX2l0ZW0tYWN0aXZlJylcbiAgICB9KTtcbiAgICBzZWN0aW9ucy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnbWFpbi1hY3RpdmUnKVxuICAgIH0pO1xuICAgIFxuICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgnbWVudV9faXRlbS1hY3RpdmUnKTtcbiAgICBsZXQgbWVudUlkID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtbWVudScpO1xuICAgIHNlY3Rpb25zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaWYoaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VjdGlvbicpID09IG1lbnVJZClcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdtYWluLWFjdGl2ZScpfSk7XG4gICAgfVxuXG5tYWluTWVudS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uTWVudSk7XG59KVxuXG5cbiIsImNsYXNzIFJlbmRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudGVhbUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbXNfX2l0ZW0nKTtcbiAgICB9XG5cbiAgICBkcm93VGVhbUxpc3QgKCl7XG4gICAgICAgIFxuICAgIH1cblxufSIsIihmdW5jdGlvbiAoKXtcbmxldCBzZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbXMtc2VsZWN0Jyk7XG5sZXQgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtcy1saXN0Jyk7XG5sZXQgaWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtcy1zZWxlY3RfX2l0ZW0nKTtcbmxldCB0ZWFtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXZpZXcnKTtcbmxldCBzZWxlY3RJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFyZ2V0SW1nJyk7XG5sZXQgc2VsZWN0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXJnZXROYW1lJyk7XG5sZXQgaW5mb01lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5mby1tZW51X19pdGVtJyk7XG5sZXQgdGVhbVNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGVhbS1zZWN0aW9uJyk7XG5sZXQgcGxheWVyc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVycy1saXN0Jyk7XG5cblxuXG5sZXQgYWxsVGVhbXMgPSAwO1xuXG5mdW5jdGlvbiBzaG93VGVhbUxpc3QoKXtcbiAgICBsaXN0LmNsYXNzTGlzdC50b2dnbGUoJ3RlYW1zLWxpc3QtYWN0aXZlJyk7XG4gICAgaWNvbi5jbGFzc0xpc3QudG9nZ2xlKCd0ZWFtcy1zZWxlY3RfX2l0ZW0tYWN0aXZlJyk7XG59XG5mdW5jdGlvbiByZW5kZXJUZWFtTGlzdCh0ZWFtTmFtZSwgdGVhbUlkKXtcbiAgICBsZXQgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgIGxpLmNsYXNzTGlzdC5hZGQoJ2xpc3Qtdmlld19faXRlbScpO1xuICAgIFxuICAgIGxldCB3cmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgd3JhcC5jbGFzc0xpc3QuYWRkKCd0ZWFtc19fbGluaycpO1xuXG4gICAgLy8gbGV0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIC8vIGltZy5jbGFzc0xpc3QuYWRkKCd0ZWFtc19fbGluay1pbWcnKTtcbiAgICAvLyBpbWcuc2V0QXR0cmlidXRlKCdocmVmJywgJyMnKTtcbiAgICBcbiAgICBsZXQgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgbmFtZS5jbGFzc0xpc3QuYWRkKCd0ZWFtc19fbGluay10aXRsZScpO1xuICAgIG5hbWUuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgdGVhbUlkKVxuICAgIG5hbWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldC5pbm5lckhUTUwpXG4gICAgICAgIHNlbGVjdE5hbWUuaW5uZXJIVE1MID0gZXZlbnQudGFyZ2V0LmlubmVySFRNTDtcbiAgICAgICAgbGV0IGlkID0gZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpO1xuICAgICAgICBzZWxlY3ROYW1lLnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGlkKTtcbiAgICAgICAgcmVtb3ZlUGxheWVyQ2FyZCgpO1xuICAgICAgICBzaG93UGxheWVycygpO1xuICAgIH0pO1xuXG4gICAgbmFtZS5pbm5lckhUTUwgPSB0ZWFtTmFtZTtcblxuICAgIC8vIHdyYXAuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICB3cmFwLmFwcGVuZENoaWxkKG5hbWUpO1xuICAgIGxpLmFwcGVuZENoaWxkKHdyYXApO1xuICAgIHRlYW1MaXN0LmFwcGVuZENoaWxkKGxpKTtcbn1cbmZ1bmN0aW9uIGNhdCAoc3RyKXtcbiAgICByZXR1cm4gc3RyLnNwbGl0KCcgJyk7IFxufVxuZnVuY3Rpb24gcmVuZGVyUGxheWVyQ2FyZChuYW1lLCBiaXJ0aGRheSwgaGVpZ2h0LCBudW1iZXIsIHBob3RvKXtcbiAgICBsZXQgY2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNhcmQuY2xhc3NMaXN0LmFkZCgncGxheWVyLWNhcmQnKTtcbiAgICBcbiAgICBsZXQgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgaW1nLmNsYXNzTGlzdC5hZGQoJ3BsYXllci1jYXJkX19pbWcnKTtcbiAgICBpbWcuc2V0QXR0cmlidXRlKCdzcmMnLCBwaG90byk7XG4gICAgXG4gICAgbGV0IGNhcmRJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY2FyZEluZm8uY2xhc3NMaXN0LmFkZCgncGxheWVyLWNhcmRfX2luZm8nKTtcbiAgICBcbiAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCdjYXJkLXRpdGxlJyk7XG4gICAgXG4gICAgbGV0IG51bSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBudW0uY2xhc3NMaXN0LmFkZCgnY2FyZC1pbmZvX19udW1iZXInKTtcbiAgICBudW0uaW5uZXJIVE1MID0gbnVtYmVyO1xuXG4gICAgbGV0IHBsYXllck5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICAgIHBsYXllck5hbWUuY2xhc3NMaXN0LmFkZCgnY2FyZC1pbmZvX19uYW1lJyk7XG4gICAgcGxheWVyTmFtZS5pbm5lckhUTUwgPSBgJHtuYW1lWzBdfSAke25hbWVbMV19YDtcblxuICAgIGxldCBiaXJ0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBiaXJ0aC5jbGFzc0xpc3QuYWRkKCdjYXJkLWluZm9fX2JpcnRoJyk7XG4gICAgYmlydGguaW5uZXJIVE1MID0gYDxzcGFuPtCU0LDRgtCwINGA0L7QttC00LXQvdC40Y86IDwvc3Bhbj4gJHtiaXJ0aGRheX1gO1xuXG4gICAgbGV0IHBsYXllckhlaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBwbGF5ZXJIZWlnaHQuY2xhc3NMaXN0LmFkZCgnY2FyZC1pbmZvX19oZWlnaHQnKTtcbiAgICBwbGF5ZXJIZWlnaHQuaW5uZXJIVE1MID0gYDxzcGFuPtCg0L7RgdGCOiA8L3NwYW4+ICR7aGVpZ2h0fWA7XG5cbiAgICBsZXQgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYnRuLmNsYXNzTGlzdC5hZGQoJ2NhcmQtaW5mb19fcHJvZmlsZScpO1xuICAgIGJ0bi5pbm5lckhUTUwgPSAn0L/QvtC00YDQvtCx0L3QtdC1JztcblxuICAgIHRpdGxlLmFwcGVuZENoaWxkKG51bSk7XG4gICAgdGl0bGUuYXBwZW5kQ2hpbGQocGxheWVyTmFtZSk7XG5cbiAgICBjYXJkSW5mby5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gICAgY2FyZEluZm8uYXBwZW5kQ2hpbGQoYmlydGgpO1xuICAgIGNhcmRJbmZvLmFwcGVuZENoaWxkKHBsYXllckhlaWdodCk7XG4gICAgY2FyZEluZm8uYXBwZW5kQ2hpbGQoYnRuKTtcblxuICAgIGNhcmQuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICBjYXJkLmFwcGVuZENoaWxkKGNhcmRJbmZvKTtcblxuICAgIHBsYXllcnNMaXN0LmFwcGVuZENoaWxkKGNhcmQpO1xufVxuZnVuY3Rpb24gcmVtb3ZlUGxheWVyQ2FyZCAoKXtcbiAgICB3aGlsZSAocGxheWVyc0xpc3QuZmlyc3RDaGlsZCkge1xuICAgICAgICBwbGF5ZXJzTGlzdC5yZW1vdmVDaGlsZChwbGF5ZXJzTGlzdC5maXJzdENoaWxkKTtcbn1cbn1cbmZ1bmN0aW9uIHNob3dQbGF5ZXJzKCkge1xuICAgIGxldCBpZCA9IHNlbGVjdE5hbWUuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG4gICAgYWxsVGVhbXNbMF0uZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgaWYoaXRlbS50ZWFtSWQgPT0gaWQpe1xuICAgICAgICAgICAgaXRlbS5wbGF5ZXJzLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyUGxheWVyQ2FyZChjYXQoaXRlbS5wbGF5ZXJOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uYmlydGhkYXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ubnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5waG90bylcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KVxuXG59XG5cbmZ1bmN0aW9uIGNob29zZVNlY3Rpb24gKCkge1xuICAgIGluZm9NZW51LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdpbmZvLW1lbnVfX2l0ZW0tYWN0aXZlJylcbiAgICB9KTtcbiAgICB0ZWFtU2VjdGlvbi5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgndGVhbS1zZWN0aW9uLWFjdGl2ZScpXG4gICAgfSk7XG4gICAgXG4gICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdpbmZvLW1lbnVfX2l0ZW0tYWN0aXZlJyk7XG4gICAgbGV0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJyk7XG4gICAgdGVhbVNlY3Rpb24uZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpZihpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJykgPT09IG5hbWUpe1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3RlYW0tc2VjdGlvbi1hY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5pbmZvTWVudS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNob29zZVNlY3Rpb24pO1xufSlcbnNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dUZWFtTGlzdCk7XG5cblxuZmV0Y2goYGh0dHA6Ly9teXZvbGxleS5ydS9hcGkvdG91cm5hbWVudD9yZXF1ZXN0PXRlYW1zJmlkPTM4NGApXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICAgICAgICAudGhlbihqc29uID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGpzb24pO1xuICAgICAgICAgICAgYWxsVGVhbXMgPSBqc29uO1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ZWRSZXN1bHQgPSBbXTtcblxuICAgICAgICAgICAganNvblswXS5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgICAgICAgICB0ZWFtTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdGVhbUlkXG4gICAgICAgICAgICAgICAgfT0gaXRlbTtcblxuICAgICAgICAgICAgICAgIGZvcm1hdGVkUmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0ZWFtTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdGVhbUlkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXRlZFJlc3VsdDtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHsgXG4gICAgICAgICAgICByZXN1bHQuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgICAgICByZW5kZXJUZWFtTGlzdChpdGVtLnRlYW1OYW1lLCBpdGVtLnRlYW1JZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbn0pKCk7IiwiXG5sZXQgdGVhbXMgPSB7XG4gICAgcnVzOiB7XG4gICAgICAgIHRpdGxlOiAnUnVzc2lhJyxcbiAgICAgICAgZmxhZzogJ2ltYWdlcy9ydXMuanBnJ1xuICAgIH1cbn1cblxubGV0IGNvdW50cnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbXNfX2xpbmstdGl0bGUnKTtcbmxldCBmbGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlYW1zX19saW5rLWltZycpO1xuXG5jb3VudHJ5LmlubmVySFRNTCA9IHRlYW1zLnJ1cy50aXRsZTtcbmZsYWcuc2V0QXR0cmlidXRlKCdzcmMnLCB0ZWFtcy5ydXMuZmxhZyk7XG5cblxuXG5cblxuXG5cbiIsImNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9vbHMtbWVudV9faXRlbScpO1xuY29uc3QgcG9vbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9vbHMtbGlzdF9faXRlbScpO1xuXG5cbmZ1bmN0aW9uIGNob29zZVBvb2wgKCkge1xuICAgIG1lbnUuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3Bvb2xzLW1lbnVfX2l0ZW0tYWN0aXZlJylcbiAgICB9KTtcbiAgICBwb29scy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgncG9vbHMtbGlzdF9faXRlbS1hY3RpdmUnKVxuICAgIH0pO1xuICAgIFxuICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgncG9vbHMtbWVudV9faXRlbS1hY3RpdmUnKTtcbiAgICBsZXQgZ3JvdXAgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1ncm91cCcpO1xuICAgIHBvb2xzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaWYoaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZ3JvdXAnKSA9PT0gZ3JvdXApe1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3Bvb2xzLWxpc3RfX2l0ZW0tYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuXG5tZW51LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2hvb3NlUG9vbCk7XG59KVxuIl19
