"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function reqListener() {
  var data = JSON.parse(this.responseText);
  console.log(data);
}

function reqError(err) {
  console.log('Fetch Error :-S', err);
}

var oReq = new XMLHttpRequest();
oReq.onload = reqListener;
oReq.onerror = reqError;
oReq.open('get', 'http://myvolley.ru/api/tournament?request=teams&id=397', true);
oReq.send();
var feed = new Instafeed({
  get: 'user',
  userId: '212406086',
  accessToken: '212406086.b242790.ad724d1a02ee43ca812e5ace3850f277'
});
feed.run();

(function () {
  var mainMenu = document.querySelectorAll('.menu__item');
  var sections = document.querySelectorAll('.main');

  function onMenu() {
    mainMenu.forEach(function (item) {
      item.classList.remove('menu__item-active');
    });
    sections.forEach(function (item) {
      item.classList.remove('main-active');
    });
    this.classList.add('menu__item-active');
    var menuId = this.getAttribute('data-menu');
    sections.forEach(function (item) {
      if (item.getAttribute('data-section') == menuId) item.classList.add('main-active');
    });
  }

  mainMenu.forEach(function (item) {
    item.addEventListener('click', onMenu);
  });
})();

(function () {
  fetch("http://myvolley.ru/api/tournament?request=news&id=397").then(function (res) {
    return res.json();
  }).then(function (json) {
    console.log(json); // allTeams = json;
    // const formatedResult = [];
    // json[0].map(item => {
    //     const {
    //         teamName,
    //         teamId
    //     }= item;
    //     formatedResult.push({
    //         teamName,
    //         teamId
    //     });
    // });
    // return formatedResult;
  });
})();

var Render =
/*#__PURE__*/
function () {
  function Render() {
    _classCallCheck(this, Render);

    this.teamList = document.querySelector('.teams__item');
  }

  _createClass(Render, [{
    key: "drowTeamList",
    value: function drowTeamList() {}
  }]);

  return Render;
}();

(function () {
  var select = document.querySelector('.teams-select');
  var list = document.querySelector('.teams-list');
  var icon = document.querySelector('.teams-select__item');
  var teamList = document.querySelector('.list-view');
  var selectImg = document.querySelector('#targetImg');
  var selectName = document.querySelector('#targetName');
  var infoMenu = document.querySelectorAll('.info-menu__item');
  var teamSection = document.querySelectorAll('.team-section');
  var playersList = document.querySelector('.players-list');
  var allTeams = 0;

  function showTeamList() {
    list.classList.toggle('teams-list-active');
    icon.classList.toggle('teams-select__item-active');
  }

  function renderTeamList(teamName, teamId) {
    var li = document.createElement('li');
    li.classList.add('list-view__item');
    var wrap = document.createElement('div');
    wrap.classList.add('teams__link'); // let img = document.createElement('img');
    // img.classList.add('teams__link-img');
    // img.setAttribute('href', '#');

    var name = document.createElement('h3');
    name.classList.add('teams__link-title');
    name.setAttribute('data-id', teamId);
    name.addEventListener('click', function () {
      console.log(event.target.innerHTML);
      selectName.innerHTML = event.target.innerHTML;
      var id = event.target.getAttribute('data-id');
      selectName.setAttribute('data-id', id);
      removePlayerCard();
      showPlayers();
    });
    name.innerHTML = teamName; // wrap.appendChild(img);

    wrap.appendChild(name);
    li.appendChild(wrap);
    teamList.appendChild(li);
  }

  function cat(str) {
    return str.split(' ');
  }

  function renderPlayerCard(name, birthday, height, number, photo) {
    var card = document.createElement('div');
    card.classList.add('player-card');
    var img = document.createElement('img');
    img.classList.add('player-card__img');
    img.setAttribute('src', photo);
    var cardInfo = document.createElement('div');
    cardInfo.classList.add('player-card__info');
    var title = document.createElement('div');
    title.classList.add('card-title');
    var num = document.createElement('p');
    num.classList.add('card-info__number');
    num.innerHTML = number;
    var playerName = document.createElement('h3');
    playerName.classList.add('card-info__name');
    playerName.innerHTML = "".concat(name[0], " ").concat(name[1]);
    var birth = document.createElement('p');
    birth.classList.add('card-info__birth');
    birth.innerHTML = "<span>\u0414\u0430\u0442\u0430 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F: </span> ".concat(birthday);
    var playerHeight = document.createElement('p');
    playerHeight.classList.add('card-info__height');
    playerHeight.innerHTML = "<span>\u0420\u043E\u0441\u0442: </span> ".concat(height);
    var btn = document.createElement('div');
    btn.classList.add('card-info__profile');
    btn.innerHTML = 'подробнее...';
    title.appendChild(num);
    title.appendChild(playerName);
    cardInfo.appendChild(title);
    cardInfo.appendChild(birth);
    cardInfo.appendChild(playerHeight);
    cardInfo.appendChild(btn);
    card.appendChild(img);
    card.appendChild(cardInfo);
    playersList.appendChild(card);
  }

  function removePlayerCard() {
    while (playersList.firstChild) {
      playersList.removeChild(playersList.firstChild);
    }
  }

  function showPlayers() {
    var id = selectName.getAttribute('data-id');
    allTeams[0].forEach(function (item) {
      if (item.teamId == id) {
        item.players.forEach(function (item) {
          renderPlayerCard(cat(item.playerName), item.birthday, item.height, item.number, item.photo);
        });
      }
    });
  }

  function chooseSection() {
    infoMenu.forEach(function (item) {
      item.classList.remove('info-menu__item-active');
    });
    teamSection.forEach(function (item) {
      item.classList.remove('team-section-active');
    });
    this.classList.add('info-menu__item-active');
    var name = this.getAttribute('data-name');
    teamSection.forEach(function (item) {
      if (item.getAttribute('data-name') === name) {
        item.classList.add('team-section-active');
      }
    });
  }

  infoMenu.forEach(function (item) {
    item.addEventListener('click', chooseSection);
  });
  select.addEventListener('click', showTeamList);
  fetch("http://myvolley.ru/api/tournament?request=teams&id=384").then(function (res) {
    return res.json();
  }).then(function (json) {
    console.log(json);
    allTeams = json;
    var formatedResult = [];
    json[0].map(function (item) {
      var teamName = item.teamName,
          teamId = item.teamId;
      formatedResult.push({
        teamName: teamName,
        teamId: teamId
      });
    });
    return formatedResult;
  }).then(function (result) {
    result.forEach(function (item) {
      renderTeamList(item.teamName, item.teamId);
    });
  });
})();

var teams = {
  rus: {
    title: 'Russia',
    flag: 'images/rus.jpg'
  }
};
var country = document.querySelector('.teams__link-title');
var flag = document.querySelector('.teams__link-img');
country.innerHTML = teams.rus.title;
flag.setAttribute('src', teams.rus.flag);
var menu = document.querySelectorAll('.pools-menu__item');
var pools = document.querySelectorAll('.pools-list__item');

function choosePool() {
  menu.forEach(function (item) {
    item.classList.remove('pools-menu__item-active');
  });
  pools.forEach(function (item) {
    item.classList.remove('pools-list__item-active');
  });
  this.classList.add('pools-menu__item-active');
  var group = this.getAttribute('data-group');
  pools.forEach(function (item) {
    if (item.getAttribute('data-group') === group) {
      item.classList.add('pools-list__item-active');
    }
  });
}

menu.forEach(function (item) {
  item.addEventListener('click', choosePool);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldERhdGEuanMiLCJpbmRleC5qcyIsIm1haW5NZW51LmpzIiwibmV3cy5qcyIsInJlbmRlci5qcyIsInRlYW1DaG9pY2UuanMiLCJ0ZWFtcy5qcyIsInR1cm5Qb29scy5qcyJdLCJuYW1lcyI6WyJyZXFMaXN0ZW5lciIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJjb25zb2xlIiwibG9nIiwicmVxRXJyb3IiLCJlcnIiLCJvUmVxIiwiWE1MSHR0cFJlcXVlc3QiLCJvbmxvYWQiLCJvbmVycm9yIiwib3BlbiIsInNlbmQiLCJmZWVkIiwiSW5zdGFmZWVkIiwiZ2V0IiwidXNlcklkIiwiYWNjZXNzVG9rZW4iLCJydW4iLCJtYWluTWVudSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInNlY3Rpb25zIiwib25NZW51IiwiZm9yRWFjaCIsIml0ZW0iLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJtZW51SWQiLCJnZXRBdHRyaWJ1dGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwianNvbiIsIlJlbmRlciIsInRlYW1MaXN0IiwicXVlcnlTZWxlY3RvciIsInNlbGVjdCIsImxpc3QiLCJpY29uIiwic2VsZWN0SW1nIiwic2VsZWN0TmFtZSIsImluZm9NZW51IiwidGVhbVNlY3Rpb24iLCJwbGF5ZXJzTGlzdCIsImFsbFRlYW1zIiwic2hvd1RlYW1MaXN0IiwidG9nZ2xlIiwicmVuZGVyVGVhbUxpc3QiLCJ0ZWFtTmFtZSIsInRlYW1JZCIsImxpIiwiY3JlYXRlRWxlbWVudCIsIndyYXAiLCJuYW1lIiwic2V0QXR0cmlidXRlIiwiZXZlbnQiLCJ0YXJnZXQiLCJpbm5lckhUTUwiLCJpZCIsInJlbW92ZVBsYXllckNhcmQiLCJzaG93UGxheWVycyIsImFwcGVuZENoaWxkIiwiY2F0Iiwic3RyIiwic3BsaXQiLCJyZW5kZXJQbGF5ZXJDYXJkIiwiYmlydGhkYXkiLCJoZWlnaHQiLCJudW1iZXIiLCJwaG90byIsImNhcmQiLCJpbWciLCJjYXJkSW5mbyIsInRpdGxlIiwibnVtIiwicGxheWVyTmFtZSIsImJpcnRoIiwicGxheWVySGVpZ2h0IiwiYnRuIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwicGxheWVycyIsImNob29zZVNlY3Rpb24iLCJmb3JtYXRlZFJlc3VsdCIsIm1hcCIsInB1c2giLCJyZXN1bHQiLCJ0ZWFtcyIsInJ1cyIsImZsYWciLCJjb3VudHJ5IiwibWVudSIsInBvb2xzIiwiY2hvb3NlUG9vbCIsImdyb3VwIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLFNBQUFBLFdBQUEsR0FBQTtBQUNBLE1BQUFDLElBQUEsR0FBQUMsSUFBQSxDQUFBQyxLQUFBLENBQUEsS0FBQUMsWUFBQSxDQUFBO0FBQ0FDLEVBQUFBLE9BQUEsQ0FBQUMsR0FBQSxDQUFBTCxJQUFBO0FBQ0E7O0FBRUEsU0FBQU0sUUFBQSxDQUFBQyxHQUFBLEVBQUE7QUFDQUgsRUFBQUEsT0FBQSxDQUFBQyxHQUFBLENBQUEsaUJBQUEsRUFBQUUsR0FBQTtBQUNBOztBQUVBLElBQUFDLElBQUEsR0FBQSxJQUFBQyxjQUFBLEVBQUE7QUFDQUQsSUFBQSxDQUFBRSxNQUFBLEdBQUFYLFdBQUE7QUFDQVMsSUFBQSxDQUFBRyxPQUFBLEdBQUFMLFFBQUE7QUFDQUUsSUFBQSxDQUFBSSxJQUFBLENBQUEsS0FBQSxFQUFBLHdEQUFBLEVBQUEsSUFBQTtBQUNBSixJQUFBLENBQUFLLElBQUE7QUNiQSxJQUFBQyxJQUFBLEdBQUEsSUFBQUMsU0FBQSxDQUFBO0FBQ0FDLEVBQUFBLEdBQUEsRUFBQSxNQURBO0FBRUFDLEVBQUFBLE1BQUEsRUFBQSxXQUZBO0FBR0FDLEVBQUFBLFdBQUEsRUFBQTtBQUhBLENBQUEsQ0FBQTtBQUtBSixJQUFBLENBQUFLLEdBQUE7O0FDTEEsQ0FBQSxZQUFBO0FBQ0EsTUFBQUMsUUFBQSxHQUFBQyxRQUFBLENBQUFDLGdCQUFBLENBQUEsYUFBQSxDQUFBO0FBQ0EsTUFBQUMsUUFBQSxHQUFB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QUssWUFBQSxDQUFBLFlBQUEsTUFBQW1FLEtBQUEsRUFBQTtBQUNBeEUsTUFBQUEsSUFBQSxDQUFBQyxTQUFBLENBQUFFLEdBQUEsQ0FBQSx5QkFBQTtBQUNBO0FBQ0EsR0FKQTtBQUtBOztBQUdBa0UsSUFBQSxDQUFBdEUsT0FBQSxDQUFBLFVBQUFDLElBQUEsRUFBQTtBQUNBQSxFQUFBQSxJQUFBLENBQUFNLGdCQUFBLENBQUEsT0FBQSxFQUFBaUUsVUFBQTtBQUNBLENBRkEiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHJlcUxpc3RlbmVyKCkgeyAgXG4gICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KTsgIFxuICAgIGNvbnNvbGUubG9nKGRhdGEpOyAgXG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHJlcUVycm9yKGVycikgeyAgXG4gICAgY29uc29sZS5sb2coJ0ZldGNoIEVycm9yIDotUycsIGVycik7ICBcbiAgfVxuICBcbiAgdmFyIG9SZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgIFxuICBvUmVxLm9ubG9hZCA9IHJlcUxpc3RlbmVyOyAgXG4gIG9SZXEub25lcnJvciA9IHJlcUVycm9yOyAgXG4gIG9SZXEub3BlbignZ2V0JywgJ2h0dHA6Ly9teXZvbGxleS5ydS9hcGkvdG91cm5hbWVudD9yZXF1ZXN0PXRlYW1zJmlkPTM5NycsIHRydWUpOyAgXG4gIG9SZXEuc2VuZCgpIiwiICAgIGxldCBmZWVkID0gbmV3IEluc3RhZmVlZCh7XG4gICAgICAgIGdldDogJ3VzZXInLFxuICAgICAgICB1c2VySWQ6ICcyMTI0MDYwODYnLFxuICAgICAgICBhY2Nlc3NUb2tlbjonMjEyNDA2MDg2LmIyNDI3OTAuYWQ3MjRkMWEwMmVlNDNjYTgxMmU1YWNlMzg1MGYyNzcnLFxuICAgIH0pO1xuICAgIGZlZWQucnVuKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgIGxldCBtYWluTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51X19pdGVtJyk7XG4gICAgbGV0IHNlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1haW4nKTtcbiAgICBcbiAgICBmdW5jdGlvbiBvbk1lbnUgKCl7XG4gICAgICAgIG1haW5NZW51LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnbWVudV9faXRlbS1hY3RpdmUnKVxuICAgICAgICB9KTtcbiAgICAgICAgc2VjdGlvbnMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdtYWluLWFjdGl2ZScpXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdtZW51X19pdGVtLWFjdGl2ZScpO1xuICAgICAgICBsZXQgbWVudUlkID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtbWVudScpO1xuICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBpZihpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWN0aW9uJykgPT0gbWVudUlkKVxuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdtYWluLWFjdGl2ZScpfSk7XG4gICAgICAgIH1cbiAgICBcbiAgICBtYWluTWVudS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk1lbnUpO1xuICAgIH0pO1xufSkoKTtcblxuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICBmZXRjaChgaHR0cDovL215dm9sbGV5LnJ1L2FwaS90b3VybmFtZW50P3JlcXVlc3Q9bmV3cyZpZD0zOTdgKVxuICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgICAgICAgLnRoZW4oanNvbiA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhqc29uKTtcbiAgICAgICAgICAgIC8vIGFsbFRlYW1zID0ganNvbjtcbiAgICAgICAgICAgIC8vIGNvbnN0IGZvcm1hdGVkUmVzdWx0ID0gW107XG5cbiAgICAgICAgICAgIC8vIGpzb25bMF0ubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgLy8gICAgIGNvbnN0IHtcbiAgICAgICAgICAgIC8vICAgICAgICAgdGVhbU5hbWUsXG4gICAgICAgICAgICAvLyAgICAgICAgIHRlYW1JZFxuICAgICAgICAgICAgLy8gICAgIH09IGl0ZW07XG5cbiAgICAgICAgICAgIC8vICAgICBmb3JtYXRlZFJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgIC8vICAgICAgICAgdGVhbU5hbWUsXG4gICAgICAgICAgICAvLyAgICAgICAgIHRlYW1JZFxuICAgICAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICAvLyByZXR1cm4gZm9ybWF0ZWRSZXN1bHQ7XG4gICAgICAgIH0pXG59KSgpOyIsImNsYXNzIFJlbmRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudGVhbUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbXNfX2l0ZW0nKTtcbiAgICB9XG5cbiAgICBkcm93VGVhbUxpc3QgKCl7XG4gICAgICAgIFxuICAgIH1cblxufSIsIihmdW5jdGlvbiAoKXtcbmxldCBzZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbXMtc2VsZWN0Jyk7XG5sZXQgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtcy1saXN0Jyk7XG5sZXQgaWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtcy1zZWxlY3RfX2l0ZW0nKTtcbmxldCB0ZWFtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXZpZXcnKTtcbmxldCBzZWxlY3RJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFyZ2V0SW1nJyk7XG5sZXQgc2VsZWN0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXJnZXROYW1lJyk7XG5sZXQgaW5mb01lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5mby1tZW51X19pdGVtJyk7XG5sZXQgdGVhbVNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGVhbS1zZWN0aW9uJyk7XG5sZXQgcGxheWVyc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVycy1saXN0Jyk7XG5cblxuXG5sZXQgYWxsVGVhbXMgPSAwO1xuXG5mdW5jdGlvbiBzaG93VGVhbUxpc3QoKXtcbiAgICBsaXN0LmNsYXNzTGlzdC50b2dnbGUoJ3RlYW1zLWxpc3QtYWN0aXZlJyk7XG4gICAgaWNvbi5jbGFzc0xpc3QudG9nZ2xlKCd0ZWFtcy1zZWxlY3RfX2l0ZW0tYWN0aXZlJyk7XG59XG5mdW5jdGlvbiByZW5kZXJUZWFtTGlzdCh0ZWFtTmFtZSwgdGVhbUlkKXtcbiAgICBsZXQgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgIGxpLmNsYXNzTGlzdC5hZGQoJ2xpc3Qtdmlld19faXRlbScpO1xuICAgIFxuICAgIGxldCB3cmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgd3JhcC5jbGFzc0xpc3QuYWRkKCd0ZWFtc19fbGluaycpO1xuXG4gICAgLy8gbGV0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIC8vIGltZy5jbGFzc0xpc3QuYWRkKCd0ZWFtc19fbGluay1pbWcnKTtcbiAgICAvLyBpbWcuc2V0QXR0cmlidXRlKCdocmVmJywgJyMnKTtcbiAgICBcbiAgICBsZXQgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgbmFtZS5jbGFzc0xpc3QuYWRkKCd0ZWFtc19fbGluay10aXRsZScpO1xuICAgIG5hbWUuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgdGVhbUlkKVxuICAgIG5hbWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldC5pbm5lckhUTUwpXG4gICAgICAgIHNlbGVjdE5hbWUuaW5uZXJIVE1MID0gZXZlbnQudGFyZ2V0LmlubmVySFRNTDtcbiAgICAgICAgbGV0IGlkID0gZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpO1xuICAgICAgICBzZWxlY3ROYW1lLnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGlkKTtcbiAgICAgICAgcmVtb3ZlUGxheWVyQ2FyZCgpO1xuICAgICAgICBzaG93UGxheWVycygpO1xuICAgIH0pO1xuXG4gICAgbmFtZS5pbm5lckhUTUwgPSB0ZWFtTmFtZTtcblxuICAgIC8vIHdyYXAuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICB3cmFwLmFwcGVuZENoaWxkKG5hbWUpO1xuICAgIGxpLmFwcGVuZENoaWxkKHdyYXApO1xuICAgIHRlYW1MaXN0LmFwcGVuZENoaWxkKGxpKTtcbn1cbmZ1bmN0aW9uIGNhdCAoc3RyKXtcbiAgICByZXR1cm4gc3RyLnNwbGl0KCcgJyk7IFxufVxuZnVuY3Rpb24gcmVuZGVyUGxheWVyQ2FyZChuYW1lLCBiaXJ0aGRheSwgaGVpZ2h0LCBudW1iZXIsIHBob3RvKXtcbiAgICBsZXQgY2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNhcmQuY2xhc3NMaXN0LmFkZCgncGxheWVyLWNhcmQnKTtcbiAgICBcbiAgICBsZXQgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgaW1nLmNsYXNzTGlzdC5hZGQoJ3BsYXllci1jYXJkX19pbWcnKTtcbiAgICBpbWcuc2V0QXR0cmlidXRlKCdzcmMnLCBwaG90byk7XG4gICAgXG4gICAgbGV0IGNhcmRJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY2FyZEluZm8uY2xhc3NMaXN0LmFkZCgncGxheWVyLWNhcmRfX2luZm8nKTtcbiAgICBcbiAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCdjYXJkLXRpdGxlJyk7XG4gICAgXG4gICAgbGV0IG51bSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBudW0uY2xhc3NMaXN0LmFkZCgnY2FyZC1pbmZvX19udW1iZXInKTtcbiAgICBudW0uaW5uZXJIVE1MID0gbnVtYmVyO1xuXG4gICAgbGV0IHBsYXllck5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICAgIHBsYXllck5hbWUuY2xhc3NMaXN0LmFkZCgnY2FyZC1pbmZvX19uYW1lJyk7XG4gICAgcGxheWVyTmFtZS5pbm5lckhUTUwgPSBgJHtuYW1lWzBdfSAke25hbWVbMV19YDtcblxuICAgIGxldCBiaXJ0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBiaXJ0aC5jbGFzc0xpc3QuYWRkKCdjYXJkLWluZm9fX2JpcnRoJyk7XG4gICAgYmlydGguaW5uZXJIVE1MID0gYDxzcGFuPtCU0LDRgtCwINGA0L7QttC00LXQvdC40Y86IDwvc3Bhbj4gJHtiaXJ0aGRheX1gO1xuXG4gICAgbGV0IHBsYXllckhlaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBwbGF5ZXJIZWlnaHQuY2xhc3NMaXN0LmFkZCgnY2FyZC1pbmZvX19oZWlnaHQnKTtcbiAgICBwbGF5ZXJIZWlnaHQuaW5uZXJIVE1MID0gYDxzcGFuPtCg0L7RgdGCOiA8L3NwYW4+ICR7aGVpZ2h0fWA7XG5cbiAgICBsZXQgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYnRuLmNsYXNzTGlzdC5hZGQoJ2NhcmQtaW5mb19fcHJvZmlsZScpO1xuICAgIGJ0bi5pbm5lckhUTUwgPSAn0L/QvtC00YDQvtCx0L3QtdC1Li4uJztcblxuICAgIHRpdGxlLmFwcGVuZENoaWxkKG51bSk7XG4gICAgdGl0bGUuYXBwZW5kQ2hpbGQocGxheWVyTmFtZSk7XG5cbiAgICBjYXJkSW5mby5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gICAgY2FyZEluZm8uYXBwZW5kQ2hpbGQoYmlydGgpO1xuICAgIGNhcmRJbmZvLmFwcGVuZENoaWxkKHBsYXllckhlaWdodCk7XG4gICAgY2FyZEluZm8uYXBwZW5kQ2hpbGQoYnRuKTtcblxuICAgIGNhcmQuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICBjYXJkLmFwcGVuZENoaWxkKGNhcmRJbmZvKTtcblxuICAgIHBsYXllcnNMaXN0LmFwcGVuZENoaWxkKGNhcmQpO1xufVxuZnVuY3Rpb24gcmVtb3ZlUGxheWVyQ2FyZCAoKXtcbiAgICB3aGlsZSAocGxheWVyc0xpc3QuZmlyc3RDaGlsZCkge1xuICAgICAgICBwbGF5ZXJzTGlzdC5yZW1vdmVDaGlsZChwbGF5ZXJzTGlzdC5maXJzdENoaWxkKTtcbn1cbn1cbmZ1bmN0aW9uIHNob3dQbGF5ZXJzKCkge1xuICAgIGxldCBpZCA9IHNlbGVjdE5hbWUuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG4gICAgYWxsVGVhbXNbMF0uZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgaWYoaXRlbS50ZWFtSWQgPT0gaWQpe1xuICAgICAgICAgICAgaXRlbS5wbGF5ZXJzLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyUGxheWVyQ2FyZChjYXQoaXRlbS5wbGF5ZXJOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uYmlydGhkYXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ubnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5waG90bylcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KVxuXG59XG5cbmZ1bmN0aW9uIGNob29zZVNlY3Rpb24gKCkge1xuICAgIGluZm9NZW51LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdpbmZvLW1lbnVfX2l0ZW0tYWN0aXZlJylcbiAgICB9KTtcbiAgICB0ZWFtU2VjdGlvbi5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgndGVhbS1zZWN0aW9uLWFjdGl2ZScpXG4gICAgfSk7XG4gICAgXG4gICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdpbmZvLW1lbnVfX2l0ZW0tYWN0aXZlJyk7XG4gICAgbGV0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJyk7XG4gICAgdGVhbVNlY3Rpb24uZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpZihpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJykgPT09IG5hbWUpe1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3RlYW0tc2VjdGlvbi1hY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5pbmZvTWVudS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNob29zZVNlY3Rpb24pO1xufSlcbnNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dUZWFtTGlzdCk7XG5cblxuZmV0Y2goYGh0dHA6Ly9teXZvbGxleS5ydS9hcGkvdG91cm5hbWVudD9yZXF1ZXN0PXRlYW1zJmlkPTM4NGApXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICAgICAgICAudGhlbihqc29uID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGpzb24pO1xuICAgICAgICAgICAgYWxsVGVhbXMgPSBqc29uO1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ZWRSZXN1bHQgPSBbXTtcblxuICAgICAgICAgICAganNvblswXS5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgICAgICAgICB0ZWFtTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdGVhbUlkXG4gICAgICAgICAgICAgICAgfT0gaXRlbTtcblxuICAgICAgICAgICAgICAgIGZvcm1hdGVkUmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0ZWFtTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdGVhbUlkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXRlZFJlc3VsdDtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHsgXG4gICAgICAgICAgICByZXN1bHQuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgICAgICByZW5kZXJUZWFtTGlzdChpdGVtLnRlYW1OYW1lLCBpdGVtLnRlYW1JZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbn0pKCk7IiwiXG5sZXQgdGVhbXMgPSB7XG4gICAgcnVzOiB7XG4gICAgICAgIHRpdGxlOiAnUnVzc2lhJyxcbiAgICAgICAgZmxhZzogJ2ltYWdlcy9ydXMuanBnJ1xuICAgIH1cbn1cblxubGV0IGNvdW50cnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbXNfX2xpbmstdGl0bGUnKTtcbmxldCBmbGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlYW1zX19saW5rLWltZycpO1xuXG5jb3VudHJ5LmlubmVySFRNTCA9IHRlYW1zLnJ1cy50aXRsZTtcbmZsYWcuc2V0QXR0cmlidXRlKCdzcmMnLCB0ZWFtcy5ydXMuZmxhZyk7XG5cblxuXG5cblxuXG5cbiIsImNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9vbHMtbWVudV9faXRlbScpO1xuY29uc3QgcG9vbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9vbHMtbGlzdF9faXRlbScpO1xuXG5cbmZ1bmN0aW9uIGNob29zZVBvb2wgKCkge1xuICAgIG1lbnUuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3Bvb2xzLW1lbnVfX2l0ZW0tYWN0aXZlJylcbiAgICB9KTtcbiAgICBwb29scy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgncG9vbHMtbGlzdF9faXRlbS1hY3RpdmUnKVxuICAgIH0pO1xuICAgIFxuICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgncG9vbHMtbWVudV9faXRlbS1hY3RpdmUnKTtcbiAgICBsZXQgZ3JvdXAgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1ncm91cCcpO1xuICAgIHBvb2xzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaWYoaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZ3JvdXAnKSA9PT0gZ3JvdXApe1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3Bvb2xzLWxpc3RfX2l0ZW0tYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuXG5tZW51LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2hvb3NlUG9vbCk7XG59KVxuIl19
