"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function reqListener() {
  var data = JSON.parse(this.responseText);
  console.log(data);
}

function reqError(err) {
  console.log('Fetch Error :-S', err);
}

var oReq = new XMLHttpRequest();
oReq.onload = reqListener;
oReq.onerror = reqError;
oReq.open('get', 'http://myvolley.ru/api/tournament?request=teams&id=397', true);
oReq.send();
var feed = new Instafeed({
  get: 'user',
  userId: '212406086',
  accessToken: '212406086.b242790.ad724d1a02ee43ca812e5ace3850f277'
});
feed.run();
var mainMenu = document.querySelectorAll('.menu__item');
var sections = document.querySelectorAll('.main');

function onMenu() {
  mainMenu.forEach(function (item) {
    item.classList.remove('menu__item-active');
  });
  sections.forEach(function (item) {
    item.classList.remove('main-active');
  });
  this.classList.add('menu__item-active');
  var menuId = this.getAttribute('data-menu');
  sections.forEach(function (item) {
    if (item.getAttribute('data-section') == menuId) item.classList.add('main-active');
  });
}

mainMenu.forEach(function (item) {
  item.addEventListener('click', onMenu);
});

var Render =
/*#__PURE__*/
function () {
  function Render() {
    _classCallCheck(this, Render);

    this.teamList = document.querySelector('.teams__item');
  }

  _createClass(Render, [{
    key: "drowTeamList",
    value: function drowTeamList() {}
  }]);

  return Render;
}();

(function () {
  var select = document.querySelector('.teams-select');
  var list = document.querySelector('.teams-list');
  var icon = document.querySelector('.teams-select__item');
  var teamList = document.querySelector('.list-view');
  var selectImg = document.querySelector('#targetImg');
  var selectName = document.querySelector('#targetName');
  var infoMenu = document.querySelectorAll('.info-menu__item');
  var teamSection = document.querySelectorAll('.team-section');
  var allTeams = 0;

  function showTeamList() {
    list.classList.toggle('teams-list-active');
    icon.classList.toggle('teams-select__item-active');
  }

  function renderTeamList(teamName) {
    var li = document.createElement('li');
    li.classList.add('list-view__item');
    var wrap = document.createElement('div');
    wrap.classList.add('teams__link'); // let img = document.createElement('img');
    // img.classList.add('teams__link-img');
    // img.setAttribute('href', '#');

    var name = document.createElement('h3');
    name.classList.add('teams__link-title');
    name.addEventListener('click', function () {
      console.log(event.target.innerHTML);
      selectName.innerHTML = event.target.innerHTML;
    });
    name.innerHTML = teamName; // wrap.appendChild(img);

    wrap.appendChild(name);
    li.appendChild(wrap);
    teamList.appendChild(li);
  }

  function setTeams() {}

  function chooseSection() {
    infoMenu.forEach(function (item) {
      item.classList.remove('info-menu__item-active');
    });
    teamSection.forEach(function (item) {
      item.classList.remove('team-section-active');
    });
    this.classList.add('info-menu__item-active');
    var name = this.getAttribute('data-name');
    teamSection.forEach(function (item) {
      if (item.getAttribute('data-name') === name) {
        item.classList.add('team-section-active');
      }
    });
  }

  infoMenu.forEach(function (item) {
    item.addEventListener('click', chooseSection);
  });
  select.addEventListener('click', showTeamList);
  fetch("http://myvolley.ru/api/tournament?request=teams&id=384").then(function (res) {
    return res.json();
  }).then(function (json) {
    console.log(json);
    allTeams = json;
    var formatedResult = [];
    json[0].map(function (item) {
      var teamName = item.teamName;
      formatedResult.push({
        teamName: teamName
      });
    });
    return formatedResult;
  }).then(function (result) {
    result.forEach(function (item) {
      renderTeamList(item.teamName);
    });
  });
})();

var teams = {
  rus: {
    title: 'Russia',
    flag: 'images/rus.jpg'
  }
};
var country = document.querySelector('.teams__link-title');
var flag = document.querySelector('.teams__link-img');
country.innerHTML = teams.rus.title;
flag.setAttribute('src', teams.rus.flag);
var menu = document.querySelectorAll('.pools-menu__item');
var pools = document.querySelectorAll('.pools-list__item');

function choosePool() {
  menu.forEach(function (item) {
    item.classList.remove('pools-menu__item-active');
  });
  pools.forEach(function (item) {
    item.classList.remove('pools-list__item-active');
  });
  this.classList.add('pools-menu__item-active');
  var group = this.getAttribute('data-group');
  pools.forEach(function (item) {
    if (item.getAttribute('data-group') === group) {
      item.classList.add('pools-list__item-active');
    }
  });
}

menu.forEach(function (item) {
  item.addEventListener('click', choosePool);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldERhdGEuanMiLCJpbmRleC5qcyIsIm1haW5NZW51LmpzIiwicmVuZGVyLmpzIiwidGVhbUNob2ljZS5qcyIsInRlYW1zLmpzIiwidHVyblBvb2xzLmpzIl0sIm5hbWVzIjpbInJlcUxpc3RlbmVyIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsImNvbnNvbGUiLCJsb2ciLCJyZXFFcnJvciIsImVyciIsIm9SZXEiLCJYTUxIdHRwUmVxdWVzdCIsIm9ubG9hZCIsIm9uZXJyb3IiLCJvcGVuIiwic2VuZCIsImZlZWQiLCJJbnN0YWZlZWQiLCJnZXQiLCJ1c2VySWQiLCJhY2Nlc3NUb2tlbiIsInJ1biIsIm1haW5NZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2VjdGlvbnMiLCJvbk1lbnUiLCJmb3JFYWNoIiwiaXRlbSIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsIm1lbnVJZCIsImdldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJSZW5kZXIiLCJ0ZWFtTGlzdCIsInF1ZXJ5U2VsZWN0b3IiLCJzZWxlY3QiLCJsaXN0IiwiaWNvbiIsInNlbGVjdEltZyIsInNlbGVjdE5hbWUiLCJpbmZvTWVudSIsInRlYW1TZWN0aW9uIiwiYWxsVGVhbXMiLCJzaG93VGVhbUxpc3QiLCJ0b2dnbGUiLCJyZW5kZXJUZWFtTGlzdCIsInRlYW1OYW1lIiwibGkiLCJjcmVhdGVFbGVtZW50Iiwid3JhcCIsIm5hbWUiLCJldmVudCIsInRhcmdldCIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwic2V0VGVhbXMiLCJjaG9vc2VTZWN0aW9uIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwianNvbiIsImZvcm1hdGVkUmVzdWx0IiwibWFwIiwicHVzaCIsInJlc3VsdCIsInRlYW1zIiwicnVzIiwidGl0bGUiLCJmbGFnIiwiY291bnRyeSIsInNldEF0dHJpYnV0ZSIsIm1lbnUiLCJwb29scyIsImNob29zZVBvb2wiLCJncm91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Q0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQUEsSUFBQUEsSUFBQSxDQUFBQyxTQUFBLENBQUFDLE1BQUEsQ0FBQSx5QkFBQTtBQUNBLEdBRkE7QUFHQTZDLEVBQUFBLEtBQUEsQ0FBQWhELE9BQUEsQ0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQUEsSUFBQUEsSUFBQSxDQUFBQyxTQUFBLENBQUFDLE1BQUEsQ0FBQSx5QkFBQTtBQUNBLEdBRkE7QUFJQSxPQUFBRCxTQUFBLENBQUFFLEdBQUEsQ0FBQSx5QkFBQTtBQUNBLE1BQUE4QyxLQUFBLEdBQUEsS0FBQTVDLFlBQUEsQ0FBQSxZQUFBLENBQUE7QUFDQTBDLEVBQUFBLEtBQUEsQ0FBQWhELE9BQUEsQ0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQSxRQUFBQSxJQUFBLENBQUFLLFlBQUEsQ0FBQSxZQUFBLE1BQUE0QyxLQUFBLEVBQUE7QUFDQWpELE1BQUFBLElBQUEsQ0FBQUMsU0FBQSxDQUFBRSxHQUFBLENBQUEseUJBQUE7QUFDQTtBQUNBLEdBSkE7QUFLQTs7QUFHQTJDLElBQUEsQ0FBQS9DLE9BQUEsQ0FBQSxVQUFBQyxJQUFBLEVBQUE7QUFDQUEsRUFBQUEsSUFBQSxDQUFBTSxnQkFBQSxDQUFBLE9BQUEsRUFBQTBDLFVBQUE7QUFDQSxDQUZBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiByZXFMaXN0ZW5lcigpIHsgIFxuICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCk7ICBcbiAgICBjb25zb2xlLmxvZyhkYXRhKTsgIFxuICB9XG4gIFxuICBmdW5jdGlvbiByZXFFcnJvcihlcnIpIHsgIFxuICAgIGNvbnNvbGUubG9nKCdGZXRjaCBFcnJvciA6LVMnLCBlcnIpOyAgXG4gIH1cbiAgXG4gIHZhciBvUmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7ICBcbiAgb1JlcS5vbmxvYWQgPSByZXFMaXN0ZW5lcjsgIFxuICBvUmVxLm9uZXJyb3IgPSByZXFFcnJvcjsgIFxuICBvUmVxLm9wZW4oJ2dldCcsICdodHRwOi8vbXl2b2xsZXkucnUvYXBpL3RvdXJuYW1lbnQ/cmVxdWVzdD10ZWFtcyZpZD0zOTcnLCB0cnVlKTsgIFxuICBvUmVxLnNlbmQoKSIsIiAgICBsZXQgZmVlZCA9IG5ldyBJbnN0YWZlZWQoe1xuICAgICAgICBnZXQ6ICd1c2VyJyxcbiAgICAgICAgdXNlcklkOiAnMjEyNDA2MDg2JyxcbiAgICAgICAgYWNjZXNzVG9rZW46JzIxMjQwNjA4Ni5iMjQyNzkwLmFkNzI0ZDFhMDJlZTQzY2E4MTJlNWFjZTM4NTBmMjc3JyxcbiAgICB9KTtcbiAgICBmZWVkLnJ1bigpO1xuIiwibGV0IG1haW5NZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnVfX2l0ZW0nKTtcbmxldCBzZWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluJyk7XG5cbmZ1bmN0aW9uIG9uTWVudSAoKXtcbiAgICBtYWluTWVudS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnbWVudV9faXRlbS1hY3RpdmUnKVxuICAgIH0pO1xuICAgIHNlY3Rpb25zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdtYWluLWFjdGl2ZScpXG4gICAgfSk7XG4gICAgXG4gICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdtZW51X19pdGVtLWFjdGl2ZScpO1xuICAgIGxldCBtZW51SWQgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1tZW51Jyk7XG4gICAgc2VjdGlvbnMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpZihpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWN0aW9uJykgPT0gbWVudUlkKVxuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ21haW4tYWN0aXZlJyl9KTtcbiAgICB9XG5cbm1haW5NZW51LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25NZW51KTtcbn0pXG5cblxuIiwiY2xhc3MgUmVuZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy50ZWFtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtc19faXRlbScpO1xuICAgIH1cblxuICAgIGRyb3dUZWFtTGlzdCAoKXtcbiAgICAgICAgXG4gICAgfVxuXG59IiwiKGZ1bmN0aW9uICgpe1xubGV0IHNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtcy1zZWxlY3QnKTtcbmxldCBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlYW1zLWxpc3QnKTtcbmxldCBpY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlYW1zLXNlbGVjdF9faXRlbScpO1xubGV0IHRlYW1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdmlldycpO1xubGV0IHNlbGVjdEltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXJnZXRJbWcnKTtcbmxldCBzZWxlY3ROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RhcmdldE5hbWUnKTtcbmxldCBpbmZvTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pbmZvLW1lbnVfX2l0ZW0nKTtcbmxldCB0ZWFtU2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50ZWFtLXNlY3Rpb24nKTtcblxuXG5sZXQgYWxsVGVhbXMgPSAwO1xuXG5mdW5jdGlvbiBzaG93VGVhbUxpc3QoKXtcbiAgICBsaXN0LmNsYXNzTGlzdC50b2dnbGUoJ3RlYW1zLWxpc3QtYWN0aXZlJyk7XG4gICAgaWNvbi5jbGFzc0xpc3QudG9nZ2xlKCd0ZWFtcy1zZWxlY3RfX2l0ZW0tYWN0aXZlJyk7XG59XG5mdW5jdGlvbiByZW5kZXJUZWFtTGlzdCh0ZWFtTmFtZSl7XG4gICAgbGV0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICBsaS5jbGFzc0xpc3QuYWRkKCdsaXN0LXZpZXdfX2l0ZW0nKTtcbiAgICBcbiAgICBsZXQgd3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHdyYXAuY2xhc3NMaXN0LmFkZCgndGVhbXNfX2xpbmsnKTtcblxuICAgIC8vIGxldCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAvLyBpbWcuY2xhc3NMaXN0LmFkZCgndGVhbXNfX2xpbmstaW1nJyk7XG4gICAgLy8gaW1nLnNldEF0dHJpYnV0ZSgnaHJlZicsICcjJyk7XG4gICAgXG4gICAgbGV0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICAgIG5hbWUuY2xhc3NMaXN0LmFkZCgndGVhbXNfX2xpbmstdGl0bGUnKTtcbiAgICBuYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQuaW5uZXJIVE1MKVxuICAgICAgICBzZWxlY3ROYW1lLmlubmVySFRNTCA9IGV2ZW50LnRhcmdldC5pbm5lckhUTUw7XG4gICAgfSk7XG5cbiAgICBuYW1lLmlubmVySFRNTCA9IHRlYW1OYW1lO1xuXG4gICAgLy8gd3JhcC5hcHBlbmRDaGlsZChpbWcpO1xuICAgIHdyYXAuYXBwZW5kQ2hpbGQobmFtZSk7XG4gICAgbGkuYXBwZW5kQ2hpbGQod3JhcCk7XG4gICAgdGVhbUxpc3QuYXBwZW5kQ2hpbGQobGkpO1xufVxuZnVuY3Rpb24gc2V0VGVhbXMoKSB7XG5cbn1cblxuZnVuY3Rpb24gY2hvb3NlU2VjdGlvbiAoKSB7XG4gICAgaW5mb01lbnUuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2luZm8tbWVudV9faXRlbS1hY3RpdmUnKVxuICAgIH0pO1xuICAgIHRlYW1TZWN0aW9uLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCd0ZWFtLXNlY3Rpb24tYWN0aXZlJylcbiAgICB9KTtcbiAgICBcbiAgICB0aGlzLmNsYXNzTGlzdC5hZGQoJ2luZm8tbWVudV9faXRlbS1hY3RpdmUnKTtcbiAgICBsZXQgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnKTtcbiAgICB0ZWFtU2VjdGlvbi5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGlmKGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnKSA9PT0gbmFtZSl7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgndGVhbS1zZWN0aW9uLWFjdGl2ZScpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cblxuaW5mb01lbnUuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjaG9vc2VTZWN0aW9uKTtcbn0pXG5zZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzaG93VGVhbUxpc3QpO1xuXG5cbmZldGNoKGBodHRwOi8vbXl2b2xsZXkucnUvYXBpL3RvdXJuYW1lbnQ/cmVxdWVzdD10ZWFtcyZpZD0zODRgKVxuICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgICAgICAgLnRoZW4oanNvbiA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhqc29uKTtcbiAgICAgICAgICAgIGFsbFRlYW1zID0ganNvbjtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdGVkUmVzdWx0ID0gW107XG5cbiAgICAgICAgICAgIGpzb25bMF0ubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgICAgICAgdGVhbU5hbWUsXG4gICAgICAgICAgICAgICAgfT0gaXRlbTtcblxuICAgICAgICAgICAgICAgIGZvcm1hdGVkUmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0ZWFtTmFtZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0ZWRSZXN1bHQ7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlc3VsdCA9PiB7IFxuICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyVGVhbUxpc3QoaXRlbS50ZWFtTmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbn0pKCk7IiwiXG5sZXQgdGVhbXMgPSB7XG4gICAgcnVzOiB7XG4gICAgICAgIHRpdGxlOiAnUnVzc2lhJyxcbiAgICAgICAgZmxhZzogJ2ltYWdlcy9ydXMuanBnJ1xuICAgIH1cbn1cblxubGV0IGNvdW50cnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbXNfX2xpbmstdGl0bGUnKTtcbmxldCBmbGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlYW1zX19saW5rLWltZycpO1xuXG5jb3VudHJ5LmlubmVySFRNTCA9IHRlYW1zLnJ1cy50aXRsZTtcbmZsYWcuc2V0QXR0cmlidXRlKCdzcmMnLCB0ZWFtcy5ydXMuZmxhZyk7XG5cblxuXG5cblxuXG5cbiIsImNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9vbHMtbWVudV9faXRlbScpO1xuY29uc3QgcG9vbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9vbHMtbGlzdF9faXRlbScpO1xuXG5cbmZ1bmN0aW9uIGNob29zZVBvb2wgKCkge1xuICAgIG1lbnUuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3Bvb2xzLW1lbnVfX2l0ZW0tYWN0aXZlJylcbiAgICB9KTtcbiAgICBwb29scy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgncG9vbHMtbGlzdF9faXRlbS1hY3RpdmUnKVxuICAgIH0pO1xuICAgIFxuICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgncG9vbHMtbWVudV9faXRlbS1hY3RpdmUnKTtcbiAgICBsZXQgZ3JvdXAgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1ncm91cCcpO1xuICAgIHBvb2xzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaWYoaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZ3JvdXAnKSA9PT0gZ3JvdXApe1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3Bvb2xzLWxpc3RfX2l0ZW0tYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuXG5tZW51LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2hvb3NlUG9vbCk7XG59KVxuIl19
